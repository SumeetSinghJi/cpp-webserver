cmake_minimum_required(VERSION 3.0)

project(cpp-webserver)

find_package(OpenSSL QUIET) # QUIET indicates silently continue, REQUIRES means quit if not found

if(NOT OpenSSL_FOUND)
    set(OPENSSL_ROOT_DIR "${CMAKE_SOURCE_DIR}/src/OpenSSL-Win64")
    set(OPENSSL_INCLUDE_DIR "${OPENSSL_ROOT_DIR}/include")

    if(WIN32)
        set(OPENSSL_LIBRARIES 
            "C:/msys64/mingw64/lib/libssl.dll.a"
            "C:/msys64/mingw64/lib/libcrypto.dll.a"
        )
    else()
        set(OPENSSL_LIBRARIES 
            "${OPENSSL_ROOT_DIR}/lib/libssl.so" 
            "${OPENSSL_ROOT_DIR}/lib/libcrypto.so"
        )
    endif()
endif()

set(SOURCES
    src/main.cpp
    src/lightweight_cpp_webserver.cpp
)

add_executable(cpp-webserver ${SOURCES})

target_include_directories(cpp-webserver PRIVATE 
    headers
    website
    ${OPENSSL_INCLUDE_DIR}
)

if(WIN32)
    target_link_libraries(cpp-webserver PRIVATE 
        ${OPENSSL_LIBRARIES} 
        Ws2_32
        )
else()
    target_link_libraries(cpp-webserver PRIVATE 
        ${OPENSSL_LIBRARIES}
    )
endif()